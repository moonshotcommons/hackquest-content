# Content/内容

### 目标

本节的目标是学习一种 Layer2 的实现方式，叫做 Optimistic (OP) Rollup。

### 问题

1. Alice 开始与客户们采取侧链的方式来进行交易，但是侧链的节点运行者是 Alice 的客户们和一些知名的跨境机构。因为 Alice 的公司赚钱过多，平常会有一些品牌溢价，赚的盆满钵满，这招来了同行们的嫉妒。于是同行们联合起来去找她的客户们，他们商量好说一起在节点运行逻辑里面作恶，把 Alice 的钱全部转走。因为侧链具备独立的共识机制和规则，只要恶意节点个数达到一定的比例，就可以发起攻击。

2. 但是这个事情被 Alice 知道了，因为其中有一个客户是她三舅妈的好朋友。Alice 必须要及时解决这个问题，否则不但生意做不下去了，连本钱都保不住了。

### 解决方案

因为这些问题的存在，Alice 就去找 Bob 请教，Bob 告诉了她一种方法叫做 Optimistic Rollup。具体的方案如下：

- Alice 跟客户们说，以后不让你们当节点了，因为你们可能联合起来作恶。我一个人独立当节点，批量打包压缩所有的交易到 Bitcoin 一层网络上去。
- 但是其他客户们说，那这样风险其实不就转嫁到我们自己身上了吗？他们强烈反对。
- 最终 Alice 和客户们想出了一个办法，就是创造出一种挑战机制，让任何人都可以去挑战提交到一层网络的最终交易状态，然后一层网络会做验证，只要真的发现 Alice 作恶，那么系统就会惩罚 Alice，例如将她的钱分给大家。
- 可是这样的挑战机制在原来的 Bitcoin 一层网络上非常难实现，因为 Bitcoin 的可编程性比较差。而这时候他们发现有一个新的 Layer1 叫做 Ethereum，它原生支持智能合约，可以写非常复杂的业务逻辑，这个挑战机制在它上面可以很容易实现。Alice 再次咨询了 Bob，确认这个方法是具备技术可行性的。
- Alice 和客户们花了一些钱将这个方案外包了出去，一个月后他们开始开心地用起来新的系统 Optimistic Rollup。

如此一来，Alice 的问题解决了，她非常开心，打算继续使用这个方案。

### **小结**

这一小节我们学习了 Optimistic Rollup 这种方案，它的技术原理如下：

1. 构建侧链：首先，创建一个独立的侧链，通常基于以太坊虚拟机（EVM）的兼容链。这个侧链可以是一个独立的区块链，也可以是一个分区（rollup）。
2. 执行和验证：在侧链上执行智能合约的交易，并验证其执行结果。验证过程通常是通过在侧链上运行一些验证节点来完成的。
3. 状态提交：在侧链上执行和验证完交易后，只需将状态的提交信息发送到以太坊主链上。这个提交信息通常包括侧链上的状态根哈希和一些证明数据，用于证明侧链上的计算是正确的。
4. 争议解决：一旦状态提交到以太坊主链上，就进入了一个争议解决期。在这个期间，任何人都可以提出对状态提交的争议，并提供相关的证据。争议解决机制通常是基于可选的仲裁者或社区投票来决定提交是否有效。
5. 回滚和奖励：如果没有争议或争议被解决并确认为无效，侧链上的状态转移将被视为有效。在这种情况下，侧链上的交易将被批准，并且参与者将获得相应的奖励。如果争议被解决并确认为有效，那么侧链上的状态转移将被回滚，并可能导致相关参与者的处罚。

它解决了纯粹的侧链容易被节点联合作恶的问题。

### 下一节

刚才提到 Optimistic Rollup 可以解决的一些问题。
但是 Optimistic Rollup 本身是否有什么缺点呢？同学们可以思考一下。
下一小节我们会讨论 Optimistic Rollup 的缺点，然后再学习一种新的 Layer2 的实现方式。

# Learn More

Optimistic Rollup 的概念最早由 Joseph Poon 在 2018 年提出。这种方法基于一个“乐观”的假设，即在主链上提交的交易默认是有效的，只有在出现争议时才进行验证。这一设计理念旨在提高交易吞吐量，减少主链上的负担。Mantle Network 在技术栈设计中就采用了 Optimistic Rollup。

代表项目：

- [Mantle Network](https://www.mantle.xyz/)