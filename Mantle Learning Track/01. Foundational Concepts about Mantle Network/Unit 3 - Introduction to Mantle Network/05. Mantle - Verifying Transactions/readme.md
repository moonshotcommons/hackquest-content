# 10. Mantle - Verifying Transactions

# Content/Content

### Objectives

The goal of this section is to learn how the TSS (Threshold Signature Scheme) module (Mantle V2 will actually remove TSS nodes) performs pre-verification of transactions on Layer2 and how the State Commitment Chain (SCC) on Layer1 handles the submission of new blocks generated by Mantle.

### **Threshold Signature Scheme (TSS) Module**

In our exploration of Alice's transaction process to Bob, we have learned how her transaction evolves from a simple network request to becoming processed data on the Mantle Network. Let's briefly recap this process: Alice's transaction is successfully processed by Sequencers and added to a block, propagated throughout the network via DTL, and subsequently, the Batch Submitter component collects these transactions, resulting in an updated state root of the blockchain. This state root is then sent to the Threshold Signature Scheme (TSS) module for verification and signing before being sent to L1.

Now, let's delve into the key module for transaction verification, the Threshold Signature Scheme (TSS).

- Background:
    - In traditional OP Rollups Layer 2 solutions, there is a prominent issue of longer challenge periods. This inconvenience arises when Mantle faces prolonged challenges, which is inconvenient for users like Alice who desire quick transaction confirmation.
    - To address this problem, the Mantle network introduces the Threshold Signature Scheme (TSS). The key aspect of this scheme is not to directly shorten the challenge period but to provide a more efficient transaction verification mechanism on Layer 2, enabling early verification on Layer 2 and indirectly reducing reliance on longer challenge periods.
    - For example, when Alice initiates a transaction on the Mantle network, TSS can quickly and preliminarily verify the correctness of her transaction on Layer 2. This efficiency improvement enhances the overall network efficiency while ensuring transaction security.
- TSS Implementation Principle:
    - The Threshold Signature Scheme (TSS) combines distributed keys with digital signatures. It allows each verified participant in the network to utilize their unique private key to generate valid signatures for the same input information. As long as there are a sufficient number of honest participants, meaning enough signatures are confirmed as valid, the signature data (input information) can be recognized as valid.
    In this way, private keys are no longer a single point of failure since each TSS client holds only a portion of the private key.
    - Imagine Alice using a special safe with the unlocking password dispersed among several trusted friends. This resembles the fundamental principle of the Threshold Signature Scheme (TSS).
        - The uniqueness of this safe lies in its collaborative unlocking capability, where each person holds only a fragment of the complete password. When verification is required, each person inputs their password fragment. When a sufficient number of honest individuals correctly input their passwords, the safe unlocks.
        - Even if one or two people input incorrect passwords or intentionally mislead, as long as the majority correctly input their password fragments, the safe will still open.
        - When it comes to verifying transactions like Alice's transfer, participants holding key fragments must collaborate. They need to use their respective keys to create a complete signature, achieving collective verification.
        - It's as if each of them provided a part of the safe's password, and only by combining these password fragments can the safe be opened.
        - The advantage of this approach is that even if some participants are dishonest, as long as there are enough honest participants, Alice's transaction can be correctly verified.
        - Since the complete key is not held by a single individual, there is no risk of a single point of failure, making the entire system more decentralized, secure, and reliable.

![Untitled](./img/10-1.png)

### **SCC（State Commitment Chain）**

After Alice's transactions are further verified and confirmed as valid by the TSS on the Mantle network, the Batch Submitter component can confidently submit the state root data that has been signed and confirmed by the TSS. The question now is, where does the Batch Submitter submit this data? We turn to another crucial component - the SCC (State Commitment Chain). The SCC is a vital part of the Mantle architecture and acts as a bridge on Layer 1.

- Background Introduction
    - In a blockchain, especially in Layer 2 solutions like Mantle, ensuring data synchronization and verification between different layers is crucial. For example, Alice's transfer is not only processed on Layer 2 but also needs to be accurately recorded on Layer 1 (Ethereum main chain).
    - A mechanism is needed to record the transaction state on Layer 2 and ensure that these transactions can be verified at any time. The SCC is designed to meet this need. As a smart contract deployed on Layer 1, it ensures that Alice's transaction state on Layer 2 can be verified and recorded on Layer 1.
- Acting as a Bridge between Layer 2 and Layer 1
    - Let's revisit the question: where does the Batch Submitter submit these successfully validated state root data? That's right, it's the SCC. As a smart contract deployed on the Ethereum main chain, the SCC receives the signed state roots from the Batch Submitter and provides a reliable data recording point for transactions initiated by users like Alice on Layer 2.
    - Imagine the SCC as a bridge connecting the Mantle Layer 2 network and the Ethereum Layer 1 main chain, ensuring seamless integration of Alice's transactions between these two layers.
- Regarding Recording and Verification
    - Once the TSS verifies the transaction state and submits it through the Batch Submitter, the SCC records this information on the Ethereum main chain, providing an immutable and permanent record of Alice's transactions.
    - Anyone can verify the correctness of Layer 2 state updates by inspecting the SCC contract on Layer 1, increasing the transparency and trustworthiness of the entire process.
- Functions and Benefits
    - Mainly addressing disputes and enhancing security:
    - If there is a dispute over a user's (Alice's) transaction data on Layer 2, it can be verified and resolved at any time by referring to the information recorded on the SCC.
    - This provides an additional layer of security for the Mantle network, ensuring that if errors occur in transactions on Layer 2 or fraudulent activities occur off-chain, there is a mechanism to detect and correct them on Layer 1.

In summary, through the SCC, the Mantle network not only effectively processes user transactions on Layer 2 but also receives confirmation and recording throughout the entire Ethereum network, greatly enhancing trust in the entire transaction process. The presence of the SCC makes the entire system more reliable, transparent, and secure for users like Alice.

![Untitled](./img/10-2.png)

### **Verifier Node**

Alice's transactions go through several important stages in the Mantle network, including packaging, verification, and confirmation. In fact, the operation of this transaction on the Mantle network is nearing completion. However, the next crucial component we will examine is the Verifier Node. These nodes are the guardians of data integrity and security in the Mantle network.

- Background Introduction:
    - In the Mantle network we introduced earlier, although the TSS has provided a reliable TSS pre-verification layer for transaction verification, a more comprehensive verification mechanism is needed to ensure the integrity and security of the system. This is where the Verifier Node comes in.
    - The Verifier Node's role is to provide an additional layer of security in the Mantle network, ensuring the accuracy and authenticity of transactions from users like Alice.
- Verification Process:
    - Verifier Nodes synchronize Layer 2 block data from DTL and are responsible for verifying the validity of this data.
    - They also check the StateRoot of each transaction block submitted by the Sequencer to ensure that it matches the known correct state. This is done by comparing it with the data recorded on Layer 1, thereby ensuring the accuracy of Layer 2 data.
    - For Alice, this means that her transaction is not only verified by the TSS but also audited by this independent "auditor" for its integrity.
- Handling Data Disputes:
    - If Verifier Nodes discover any issues in the data extracted from the Data Availability layer (Mantle DA) that may cause disputes (such as disputed transactions or state updates), they can challenge this data by submitting a Fraud Proof. The Fraud Proof contains sufficient information to prove that a specific transaction or state update is incorrect. For example, if Alice initiates a transaction but a Verifier Node detects an issue in the processing of that transaction, the node can generate a Fraud Proof and submit it to the network to point out this error.
        - Note: Fraud Proof is a mechanism in blockchain that allows participants to challenge transactions orstate updates that are deemed invalid or fraudulent. It provides a way to dispute and correct erroneous data.
- Benefits of Verifier Nodes:
    - Enhanced Security: Verifier Nodes play a crucial role in maintaining the security and integrity of the Mantle network. By independently verifying the data and cross-referencing it with the state recorded on Layer 1, they act as a safeguard against potential fraudulent or incorrect transactions.
    - Dispute Resolution: Verifier Nodes help in resolving data disputes by submitting Fraud Proofs when they detect discrepancies or errors in the data. This ensures that any inaccuracies or fraudulent activities can be addressed and corrected.
    - Trust and Transparency: The presence of Verifier Nodes adds an additional layer of trust and transparency to the Mantle network. Users like Alice can have confidence that their transactions are thoroughly audited and verified by independent nodes, reducing the risk of malicious activities or manipulation.
    - System Reliability: Verifier Nodes contribute to the overall reliability of the Mantle network. Their continuous monitoring and verification help maintain the accuracy and consistency of data across layers, making the system more robust and resilient.

In summary, Verifier Nodes act as auditors and guardians of data integrity in the Mantle network. By independently verifying transactions and cross-referencing them with the state recorded on Layer 1, they enhance security, facilitate dispute resolution, and promote trust and transparency. Their presence ensures the reliability and integrity of the entire system, benefiting users like Alice and the overall network ecosystem.

![Untitled](./img/10-3.png)

### Next lesson

Congratulations on completing the lesson on transaction verification on Mantle. In the next section, we will learn about how Mantle Layer2 data is stored.
